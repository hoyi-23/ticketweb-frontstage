{"version":3,"file":"static/js/245.1d7a4f17.js","mappings":"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","sources":["webpack://ticketweb-frontstage/./src/views/CheckOut.vue","webpack://ticketweb-frontstage/./src/views/CheckOut.vue?db84"],"sourcesContent":["<template>\r\n    <div class=\"checkout py-5\">\r\n        <div class=\"container \">\r\n            <!--購物車內容-->\r\n            <div class=\"table-responsive-lg\">\r\n                <h2 class=\"fs-3 mb-3\">購買內容</h2>\r\n                <table class=\"table table-hover table-primary py-3 text-center\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th scope=\"col\">#</th>\r\n                            <th scope=\"col\">票券名稱</th>\r\n                            <th scope=\"col\" class=\"text-nowrap\">全票</th>\r\n                            <th scope=\"col\" class=\"text-nowrap\">學生票</th>\r\n                            <th scope=\"col\" class=\"text-nowrap\">優惠票</th>\r\n                            <th scope=\"col\" class=\"text-nowrap\">小計</th>\r\n                            <th scope=\"col\" class=\"text-nowrap\">刪除</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody v-if=\"cartItem.length <= 0\">\r\n                        <tr>\r\n                            <td colspan=\"7\">哇! 空空如也!<br>再去逛逛吧</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td colspan=\"7\">\r\n                                <router-link to=\"/search\" class=\"btn btn-secondary\">探索活動</router-link>\r\n                            </td>\r\n                        </tr>    \r\n                        \r\n                    </tbody>\r\n                    <tbody v-else>\r\n                        <tr v-for=\"(item,index) in cartItem\" :key=\"index\">\r\n                            <th scope=\"row\">{{`${index+1}`}}</th>\r\n                            <td class=\"text-nowrap\">{{item.title}}</td>\r\n                            <td>{{item.num.full}}</td>\r\n                            <td>{{item.num.student}}</td>\r\n                            <td>{{item.num.discount}}</td>\r\n                            <td>{{item.subTotal}}</td>\r\n                            <td>\r\n                                <a href=\"#\" @click.prevent=\"deleteFromCart(index,item.subTotal)\">\r\n                                    <span class=\"material-icons-outlined\">delete_forever</span>\r\n                                </a>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                    <tfoot>\r\n                        <tr>\r\n                            <th scope=\"row\" class=\"text-nowrap\">總計</th>\r\n                            <td colspan=\"5\"></td>\r\n                            <td class=\"fs-2 fw-bold\">{{total}}</td>\r\n                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n            <hr>\r\n            <form @submit.prevent=\"submitCheckoutForm\" class=\"buyerInfo row g-3\">\r\n                <div class=\"d-flex align-items-center\">\r\n                    <h2 class=\"fs-3\">填寫購買資訊</h2>\r\n                    <div class=\"form-check ms-5\">\r\n                        <input class=\"form-check-input\" type=\"checkbox\" id=\"sameAsUser\" v-model=\"sameAsUser\">\r\n                        <label class=\"form-check-label\" for=\"sameAsUser\">\r\n                            帶入用戶資料\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-md-6\">\r\n                    <label for=\"validationDefault01\" class=\"form-label\">購買人姓名</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"validationDefault01\" placeholder=\"請填寫全名\" v-model=\"buyer.name\" required>\r\n                </div>\r\n                <div class=\"col-md-6\">\r\n                    <label for=\"validationDefault02\" class=\"form-label\">電子信箱</label>\r\n                    <input type=\"email\" class=\"form-control\" id=\"validationDefault02\" placeholder=\"xxx@gmail.com\" v-model=\"buyer.email\" required>\r\n                </div>\r\n                <div class=\"col-md-6\">\r\n                    <label for=\"validationDefault03\" class=\"form-label\">連絡電話</label>\r\n                    <input type=\"tel\" class=\"form-control\" id=\"validationDefault03\" placeholder=\"09xxxxxxxx\" v-model=\"buyer.tele\" required>\r\n                </div>\r\n                <div class=\"col-md-6\">\r\n                    <label for=\"validationDefault04\" class=\"form-label\">付款方式</label>\r\n                    <select class=\"form-select\" id=\"validationDefault04\" v-model=\"buyer.payment\" required>\r\n                        <option selected disabled value=\"\">請選擇付款方式</option>\r\n                        <option value=\"cash\">超商付款取票</option>\r\n                        <option value=\"credit\">線上付款</option>\r\n                    </select>\r\n                </div>\r\n                <!--信用卡資訊 if payment == credit card-->\r\n                <transition name=\"fade\">\r\n                    <div class=\"col-md-6\" v-if=\"buyer.payment == 'credit'\">\r\n                        <div class=\"rounded bg-primary p-3 text-white\">\r\n                            <p class=\"fs-5\">信用卡資訊</p>\r\n                            <div class=\"row g-3\">\r\n                                <div class=\"col-md-6\">\r\n                                    <label for=\"validationDefault04\" class=\"form-label\">信用卡持有人</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"validationDefault04\" placeholder=\"請填寫全名\" v-model=\"buyer.creditCard.name\" required>\r\n                                </div>\r\n                                <div class=\"col-md-6\">\r\n                                    <label for=\"validationDefault05\" class=\"form-label\">信用卡號碼(16碼)</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"validationDefault05\" placeholder=\"xxxx xxxx xxxx xxxx\" v-model=\"buyer.creditCard.num\" required>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <label for=\"validationDefault06\" class=\"form-label\">到期日(Exp)</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"validationDefault06\" placeholder=\"xx/xx\" v-model=\"buyer.creditCard.exp\" required>\r\n                                </div>\r\n                                <div class=\"col-md-3\">\r\n                                    <label for=\"validationDefault07\" class=\"form-label\">驗證碼(3碼)</label>\r\n                                    <input type=\"text\" class=\"form-control\" id=\"validationDefault07\" placeholder=\"xxx\" v-model=\"buyer.creditCard.verified\" required>\r\n                                </div>\r\n                            </div>\r\n                        </div> \r\n                    </div>\r\n                </transition>\r\n                <div class=\"col-12 d-flex align-items-center justify-content-end\">\r\n                    <div class=\"form-check me-4\">\r\n                        <input class=\"form-check-input\" type=\"checkbox\" id=\"invalidCheck2\" v-model=\"buyer.agreement\" required>\r\n                        <label class=\"form-check-label\" for=\"invalidCheck2\">\r\n                            Agree to terms and conditions\r\n                        </label>\r\n                    </div>\r\n                    <!-- if payment == credit card-->\r\n                    <button type=\"submit\" v-if=\"buyer.payment == 'credit'\" class=\"btn btn-primary\">確認付款</button>\r\n                    <!-- else-->\r\n                    <button type=\"submit\" v-else class=\"btn btn-primary\">送出訂單</button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {useStore} from 'vuex'\r\nimport {computed,ref,watch} from 'vue'\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/firestore'\r\nimport {useRouter} from 'vue-router'\r\nexport default {\r\n    name: 'CheckOut',\r\n\r\n    setup(){\r\n        const store = useStore()\r\n        const router = useRouter()\r\n        //購物車內容\r\n        const cartItem = computed(()=>store.getters.cartContent)\r\n\r\n        function deleteFromCart(index,subTotal){\r\n            store.dispatch('deleteFromCart',{index,subTotal})\r\n        }\r\n        const total = computed(()=>store.getters.total)\r\n        //購買資訊\r\n        const userData = computed(()=>store.getters.user)\r\n\r\n        const sameAsUser = ref()\r\n        const buyer = ref({\r\n            name: null,\r\n            email: null,\r\n            tele: null,\r\n            payment: null,\r\n            isPaid: null,\r\n            agreement: null,\r\n            creditCard: {\r\n                name: null,\r\n                num: null,\r\n                exp: null,\r\n                verified: null\r\n            }\r\n\r\n        })\r\n        //若帶入會員資料為true，判斷會員資料使否有填寫，若有填入，若無alert尚未填寫會員資料\r\n        watch(sameAsUser,val =>{\r\n            if(val == true){\r\n                buyer.value.name = userData.value.displayName\r\n                buyer.value.email = userData.value.email\r\n                buyer.value.tele = userData.value.phoneNumber\r\n            }else{\r\n                buyer.value.name = null\r\n                buyer.value.email = null\r\n                buyer.value.tele = null\r\n            }\r\n        })\r\n\r\n        //送出表單\r\n        async function submitCheckoutForm(){\r\n            //收款與否目前先以簡單的按 結帳 或 下訂單 按鈕做區分 \r\n            if(buyer.value.payment == 'credit'){\r\n                buyer.value.isPaid == true\r\n            }else{\r\n                buyer.value.isPaid == false\r\n            }\r\n            const ordersCollection = await firebase.firestore(firebase.apps[1]).collection('order').doc();\r\n            await ordersCollection.set({\r\n                userId: userData.value.uid,\r\n                buyerInfo: buyer.value,\r\n                purchaseItems: cartItem.value,\r\n                total: total.value\r\n            })\r\n            alert('訂單建立成功')\r\n            router.push({\r\n                path: '/admin/myticket'\r\n            })\r\n            store.dispatch('clearCart')\r\n        }\r\n        return{\r\n            cartItem,\r\n            deleteFromCart,\r\n            total,\r\n            userData,\r\n\r\n            //form data\r\n            sameAsUser,\r\n            buyer,\r\n\r\n            //checkoutForm\r\n            submitCheckoutForm\r\n\r\n\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.fade-enter-active, .fade-leave-active {\r\n  transition: opacity .5s;\r\n}\r\n.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {\r\n  opacity: 0;\r\n}\r\n</style>","import { render } from \"./CheckOut.vue?vue&type=template&id=1e1b78b2&scoped=true\"\nimport script from \"./CheckOut.vue?vue&type=script&lang=js\"\nexport * from \"./CheckOut.vue?vue&type=script&lang=js\"\n\nimport \"./CheckOut.vue?vue&type=style&index=0&id=1e1b78b2&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-1e1b78b2\"\n\nexport default script"],"names":["class","scope","colspan","for","selected","disabled","value","type","cartItem","length","to","item","index","key","title","num","full","student","discount","subTotal","href","deleteFromCart","total","submitCheckoutForm","id","sameAsUser","placeholder","buyer","name","required","email","tele","payment","creditCard","exp","verified","agreement","setup","store","router","getters","cartContent","dispatch","userData","user","isPaid","async","ordersCollection","collection","doc","set","userId","uid","buyerInfo","purchaseItems","alert","push","path","val","displayName","phoneNumber","render"],"sourceRoot":""}